@using MovieStreaming.Areas.Admin.Models.User;
@model Login
@{
    Layout = null;
}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] Movie Streaming</title>
    <link rel="shortcut icon" href="~/images/favikon.ico">
    <link href="~/css/bootstrap.min.css" id="bootstrap-style" rel="stylesheet" type="text/css">
    <link href="~/css/icons.min.css" rel="stylesheet" type="text/css">
    <link href="~/css/app.min.css" id="app-style" rel="stylesheet" type="text/css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.min.js"></script>

</head>


<body>
    <div class="auth-page">
        <div class="container-fluid p-0">
            <div class="row g-0 align-items-center">
                <div class="col-xxl-4 col-lg-4 col-md-6">
                    <div class="row justify-content-center g-0">
                        <div class="col-xl-9">
                            <div class="p-4">
                                <div class="card mb-0">
                                    <div class="card-body">
                                        <div class="auth-full-page-content rounded d-flex p-3 my-2">
                                            <div class="w-100">
                                                <div class="d-flex flex-column h-100">
                                                    <div class="mb-4 mb-md-5">
                                                      
                                                    </div>
                                                    <div class="auth-content my-auto">
                                                        <div class="text-center">
                                                            <h5 class="mb-0">Welcome Back!</h5>  
                                                            <p class="text-muted mt-2">Sign in to continue to your Movies</p>
                                                        </div>
                                                        <form class="mt-4 pt-2" id="LoginInForm" method="post">
                                                            <div class="form-floating form-floating-custom mb-4">
                                                                <input asp-for="Username" type="text" class="form-control" id="input-username" placeholder="Email">
                                                              <label for="input-username">Email</label>
                                                                <div class="form-floating-icon">
                                                                    <i data-eva="people-outline"></i>
                                                                </div>
                                                            </div>

                                                            <div class="form-floating form-floating-custom mb-4 auth-pass-inputgroup">
                                                                <input asp-for="Password" type="password" class="form-control pe-5" id="password-input" placeholder="Enter Password">
                                                             
                                                                <button type="button" class="btn btn-link position-absolute h-100 end-0 top-0" id="password-addon">
                                                                    <i class="mdi mdi-eye-outline font-size-18 text-muted"></i>
                                                                </button>
                                                                <label for="input-password">Password</label>
                                                                <div class="form-floating-icon">
                                                                    <i data-eva="lock-outline"></i>
                                                                </div>
                                                            </div>

                                                            @Html.ValidationSummary(true)

                                                            <div class="row mb-4">
                                                                <div class="col">

                                                                    <p class="text-danger requestedField" style="display:none">Please fill all the fields!</p>
                                                                     <p class="text-danger usernameOrPasswordIncorrect" style="display:none">Username or password are incorrect!</p>

                                                                </div>

                                                            </div>
                                                            <div class="mb-3">
                                                                <button class="btn btn-primary w-100 waves-effect waves-light" type="submit">Log In</button>
                                                            </div>

                                                         </form>
                                                                                                             
                                                        <div class="mt-4 pt-3 text-center">
                                                            <div class="signin-other-title">
                                                                <h5 class="font-size-14 mb-4 text-muted fw-medium">- Or you can join with -</h5>
                                                            </div>

                                                            <div class="d-flex gap-2">
                                                                <a type="button" class="btn btn-soft-primary waves-effect waves-light w-100 " href="@Url.Action("Facebook","Account")">
                                                                    <i class="bx bxl-facebook font-size-16 align-middle"></i>
                                                                </a>
                                                            </div>
                                                        </div> 
                                                        <div class="mt-4 pt-3 text-center">
                                                            <p class="text-muted mb-0">
                                                                Don't have an account ? <a href="@Url.Action("SignUp","Account")"
                                                                                           class="text-primary fw-semibold"> Sign up now </a>
                                                            </p>
                                                            <p class="text-muted mb-0">
                                                                Forgot your password ? <a href="@Url.Action("ForgotPassword","ResetPassword")"
                                                                                           class="text-primary fw-semibold">Click here </a>
                                                            </p>
                                                        </div>
                                                    </div>
                                                    
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- end auth full page content -->
                </div>
                <!-- end col -->
                <div class="col-xxl-8 col-lg-8 col-md-6">
                    <div class="auth-bg bg-white py-md-5 p-4 d-flex">
                        <div class="bg-overlay bg-white"></div>
                        <!-- end bubble effect -->
                        <div class="row justify-content-center align-items-center">
                            <div class="col-xl-8">
                                <div class="mt-4">
                                    <img style="width: 1103px;height: 714px; right: -110px; position: relative;" src="~/images/movie_login.png" class="img-fluid" alt="">
                                </div>
                                <div class="p-0 p-sm-4 px-xl-0 py-5">
                                    <div style="right: -325px" id="reviewcarouselIndicators" class="carousel slide auth-carousel" data-bs-ride="carousel">
                                        <div class="carousel-indicators carousel-indicators-rounded">
                                            <button type="button" data-bs-target="#reviewcarouselIndicators" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
                                            <button type="button" data-bs-target="#reviewcarouselIndicators" data-bs-slide-to="1" aria-label="Slide 2"></button>
                                            <button type="button" data-bs-target="#reviewcarouselIndicators" data-bs-slide-to="2" aria-label="Slide 3"></button>
                                        </div>

                                        <!-- end carouselIndicators -->
                                        <div style="margin-left: 300px;" class="carousel-inner w-75 mx-auto">
                                            <div class="carousel-item active">
                                                <div class="testi-contain text-center">
                                                    <h5 class="font-size-20 mt-4">
                                                        Once Upon A Time In Hollywood
                                                    </h5>
                                                    <p class="font-size-15 text-muted mt-3 mb-0">
                                                        Amazing and accurate movie.
                                                    </p>
                                                </div>
                                            </div>

                                            <div class="carousel-item">
                                                <div class="testi-contain text-center">
                                                    <h5 class="font-size-20 mt-4">
                                                        Marvel Cinematic Universe
                                                    </h5>
                                                    <p class="font-size-15 text-muted mt-3 mb-0">
                                                        Incredible CGI.
                                                    </p>
                                                </div>
                                            </div>

                                            <div class="carousel-item">
                                                <div class="testi-contain text-center">
                                                    <h5 class="font-size-20 mt-4">
                                                        The Last of Us
                                                    </h5>
                                                    <p class="font-size-15 text-muted mt-3 mb-0">
                                                        Touching story.
                                                    </p>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- end carousel-inner -->
                                    </div>
                                    <!-- end review carousel -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- end col -->
            </div>
            <!-- end row -->
        </div>
        <!-- end container fluid -->
    </div>
    <script src="~/libs/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="~/libs/metismenujs/metismenujs.min.js"></script>
    <script src="~/libs/simplebar/simplebar.min.js"></script>
    <script src="~/libs/eva-icons/eva.min.js"></script>
    <script src="~/js/pages/pass-addon.init.js"></script>
    <script src="~/js/pages/eva-icon.init.js"></script>
    <script src="~/js/form-validation.js"></script>
    <script src="~/plugins/jquery/jquery.min.js"></script>
    <script src="~/js/custom.js"></script>

    <style>
        .img-fluid{
            max-width: none;
        }
    </style>
    <script>
        $(document).ready(function () {
            $(document).on('submit', "#LoginInForm", function (e) {
                var form = $(this);
                $.ajax({
                    type: "POST",
                    url: "@Url.Action("Login", "Account")",
                    data: form.serialize(), // serializes the form's elements.
                    success: function (data) {
                        console.log(data)
                        if (data.IsSuccessful && data.IsAdmin) {
                            top.location.href = '@Url.Action("Index", "Home", new { area = "Admin" })';
                        }else if(data.IsSuccessful && !data.IsAdmin){
                            top.location.href = '@Url.Action("Index", "Dashboard", new { area = "Users" })';
                        }else if (data.FailedValidation) {
                            $(".requestedField").css("display", "block");
                        } else if (data.IncorrectCredenials) {
                            $(".requestedField").css("display", "none");
                            $(".usernameOrPasswordIncorrect").css("display", "block");
                           
                        }
                        else if (data.WaitingConfirmation) {
                            $('.form-control').val('');
                            $('select').find('option:not(:first)').remove();
                            swal(
                                {
                                    title: 'Your request is in the proccess!',
                                    text: 'Your account has not approved yet! We will notify you..',
                                    type: 'warning',
                                    confirmButtonColor: '#3b76e1'
                                }
                            )
                        }
                        else if (!data.WaitingConfirmation) {
                            if (!data.IsApproved) {
                                $('.form-control').val('');
                                $('select').find('option:not(:first)').remove();
                                swal(
                                    {
                                        title: 'Your request has not approved!',
                                        text: 'Your account has not approved! Try to register again...',
                                        type: 'error',
                                        confirmButtonColor: '#3b76e1'
                                    }
                                )
                            }
                        }
                    }
                });
                e.preventDefault();
            });
        }
        )
    </script>

</body>
</html>